В основната контрола на програмата имаме Текстов редактор и Брайлов изглед, между които тече постоянен процес на преобразуване от обикновен текст към брайлов код.
При този процес  се създават междинни обекти, в които се обработва и съхранява информация.

Във форматирането на символите и параграфите в текстовия редактор са зададени характеристики, които имат значение за преобразуването и могат да водят до значителни преобразувания в брайловия текст. Например параграфите със стил хединг , служат за създаване на Съдържание (Table of content). Също така, бележките под линия в досегашните текстове, предназначени за брайл, са вмъквани директно в текста, поставени между отваряща и затваряща команда.


----------

Процесът на преобразуване

Целият процес на преобразуване към брайлов код изглежда така:

В текстовия редактор:
- Зареждане или Въвеждане на текст;
- Форматиране на текст;
- Задаване на структура на документа - къде започват томовете и разделите;
- Задаване на шаблони за разделите;

В междинния обект (в пейдж мениджъра):
- Създава и поддържа списък с хедингите за всички раздели на даден том;
- Създава и поддържа списък с номерирани бележки под линия;
- създава и поддържа списък с макросите.
- създава и поддържа списък на съответните позиции между символ от редактора и неговия брайлов код от брайловия изгред.

В брайловия изглед се съхранява и поддържа актуален брайловия код с помощта на Пейдж мениджър.
Шаблоните се прилагат от Пейдж мениджър, чиято функция е да странира цялата брайлова публикация.
Един шаблон се прилага към един раздел и създава една или повече страници.
Шаблонът може да има за източник на съдържание:

- Текстът на раздела, към който е приложен шаблона. Текстът се изчита от раздела, като бележките под линия се заменят с техните номера или обозначения.
- Списъкът с номерираните бележки под линия.
- Списъкът с параграфите, форматирани като хединги.
- Статичен текст, въведен в конкретната кутия на шаблона.
- Списък с макроси.

Шаблонът създава и започва да изпълва страницата според размера и съдържанието на кутиите, зададени за този шаблон.
Когато някоя от кутиите не побере текста, извлечен от източника, шаблонът, след като изпълни всичките кутии, създава нова страница, за която отново запълва кутиите.
Шаблонът ползва информация от пейдж мениджъра.
Например:
- Поредност на настоящата страница;
- Номер на настоящата страница (може да е различен от поредността на страницата);
- След кой хединг е процесът на преобразуване;
- След коя бележка под линия е процесът на преобразуване;
- в кой том и кой раздел е преобразуването;
- ...




Особености при бележките под линия

При набиране на текста за брайл в досегашната практика служителите изписват бележката под линия направо на мястото, където е нейното обозначение, а при транслирането, транслаторът изрязва текста на бележката от това място и там поставя съответния номер или обозначение<$fТова е примерна бележка под линия>.
Текстът на бележката под линия при брайловите издания се поставя в началото на следващата страница и се разделя от следващия текст на страницата с черта.
Затова, възможно е една страница да започва с текстовете на бележките под линия от предходната страница и след черта, да продължи с основния текст.
Това може да се постигне с шаблон за страница, в който имаме поне две кутии:
- Кутия  с източник бележки под линия и с минимална височина 0;
- Кутия с източник текста на раздела и с минимална височина 0.
Понеже минимално изискуемата височина на кутията за бележки под линия е 0, шаблонът ще създаде такава кутия само ако в предходната страница има обозначения за бележки под линия. Ако няма кутия с бележки под линия, цялата страница ще се изпълни само с основния текст на раздела. Ако пък бележките под линия изискват повече от една страница, те ще изпълнят страницата, на нея няма да има основен текст, а следващата страница ще продължи бележките под линия и евентуално основния текст.
За да се случва това, е необходимо шаблонът да разполага с информация за текущото състояние (виж по-горе).





Особености при хедингите и извличане на съдържанието (Table of contents)

Стиловете за параграф, които са хединг 1, 2  или 3, служат за извличане на съдържание.
Тъй като реалните брайлови книги са твърде обемисти, се налага често те да се изпринтват в по няколко тома като всеки том трябва да започва със свое съдържание.
При брайловите книги е прието съдържанието да се помести върху страници, чиято номерация следва номерацията на цялата публикация и е възможно например в първи том съдържанието да започва на страница 3, първа глава да е на страница 5, том 1 да свършва на страница 130, втори том да започва от стр. 131 със съдържание, на стр. 136 да е Глава 11 и т.н.
Тъй като в съдържанието трябва да се посочи номер на страница на Глава Х, която е след самото съдържание, програмата някак трябва след като форматира и странира текста на съответния том, да изписва номера на страницата, на която се намира дадения хединг.
За да се случва това, е необходимо списъкът с хединги да съдържа за всеки хединг и поле с минимална дължина от например 8 символа. В това поле може да се побере номер на страницата и няколко интервала пред него. В записа за хединга трябва да се съхрани и информация за тома, в който се намира.

За да се извлича съдържание на един том е необходимо да се  създаде раздел, в който да има кутия с източник Списъка с хединги.
Дейдж мениджърът трябва да извлича и поддържа списъка с хединги от всички раздели от текущия том. Това ще става лесно ако за всеки хединг се съхранява информация за тома, в който се намира.


Макроси

Това е списък от команди, които връщат  резултат - обикновено текст в брайлов код. Тяхното предназначение е да дават необходима за шаблоните информация.
На първо време ще има следните вградени макроси:
Номер на текуща страница; Номер на последна страница на публикацията; Номер на последна страница на текущия том; Номер на текущия том;  Заглавие на публикацията; Автор; Текущ хединг от ниво 1, от ниво 2, от ниво 3;
Би било добре в някакъв момент да се зададат вградени макроси позволяващи параметри. Например:
Търсене - с параметри: Текст, формат, Цел, формат на резултата;
Вмъкване - с параметри: Име на файл, формат на резултата;
Вмъкване от команда - с параметри: Външна команда, Параметри за външна команда, Формат на резултата.

За всяка публикация ще могат да се задават и ръчно макроси като директно съответствие между името на макроса и неговото съдържание изписано с брайлови кодове.

Макросите са един от възможните източници на съдържание в кутиите на шаблон. Заедно с наименованите стилове за параграф и шаблоните за страница, ръчните макроси се създават и изтриват в таба Формат на контролата.






----------

Пейдж мениджърът

Той е отговорен за  създаването и поддържането на брайловия код на публикацията. В него трябва да има и функциите за изпращане към брайлов принтер.

За да функционира, той ползва информацията от текстовия редактор, от наименоваинте стилове за параграф, шаблоните и макросите.
Той създава помощни обекти, в които съхранява междинните състояния - списък с хединги, списък с бележки под линия и др.
Важен помощен списък съдържа информация за съответствието между символите от брайловия изглед и текстовия редактор. Този списък позволява потребителят, разглеждащ брайловия код лесно да преминава на същия символ от текстовия редактор, и обратно.
Като резултат от функционирането на мениджъра, се създава и поддържа актуален списък с форматирани страници с брайлов код, готови за брайлово принтене. 
Извлечен ред по ред, текстът на тези страници се визуализира в прозореца за брайловия изглед.

Как функционира мениджъра

Първоначално, след зареждане на брайловия документ:
Свързва се   с текстовия редактор
Свързва се  със списъците за шаблони, наименовани стилове за параграф и макроси  от заредения брайлов документ;
Създава помощни обекти - списък на хедингите, на бележките под линия, на съответствията между позициите на редактора и брайловия код и др.
Попълва списъците за хединги и за бележки под линия.
Създава списъка със страници за брайловия код.

За всеки раздел от том прилага избрания шаблон като:
За всяка кутия от шаблона извлича от източника необходимия текст и го пише върху страницата за брайлов код. Когато източникът е текст, хединг или бележка под линия, съхранява съответствието между брайловите кодове и символите от редактора. За всеки хединг създава запис, в който се съхранява и номера на тома и полето (8 символа) за номер на страница. За всяка бележка под линия създава запис с бележката под линия, нейния номер и избрания начин за обозначаване; мястото на бележката в текста се заменя от посочката към бележката, а списъка със записи на бележки под линия служи като източник на друга кутия.
Когато се изпълнят всички кутии и някоя от кутиите изисква още място, добавя нова страница за брайлов код и започва да я пълни.
Когато шаблонът бъде приложен, мениджърът минава към следващ раздел и така, до края.

След това първоначално конструиране, мениджърът продължава в режим на изчакване на промени:

Следи за настъпили промени в текстовия редактор, стиловете, шаблоните и макросите.
Когато настъпи промяна, извършва промени само в тези страници, които са засегнати.
